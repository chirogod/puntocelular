"use strict"; var _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }; function _defineProperty(e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e } !function (e) { var t = Function("return this")() || (0, eval)("this"); "function" == typeof define && define.amd ? define(["jquery"], function (n) { return e(n, t) }) : "object" === ("undefined" == typeof exports ? "undefined" : _typeof(exports)) ? module.exports = e(require("jquery"), t) : t.PatternLock = e(t.jQuery, t) }(function (e, t) { var n, o = "http://www.w3.org/2000/svg", r = "touchmove mousemove", i = (_defineProperty(n = { 37: !0, 38: !0, 39: !0, 40: !0, 32: !0 }, "38", !0), _defineProperty(n, 34, !0), _defineProperty(n, 35, !0), _defineProperty(n, 36, !0), n); function u(n, c) { var s = e(n), a = this, f = s[0], l = s.find(".lock-dots circle"), d = s.find(".lock-lines"), v = s.find(".lock-actives"), m = f.createSVGPoint(), y = [], p = void 0, b = void 0; function h() { s.removeClass("error"), s.addClass("success") } function g() { s.removeClass("success"), s.addClass("error") } function x() { e("g.lock-lines").addClass("hide-lines") } function A() { e("g.lock-lines").removeClass("hide-lines") } function w() { let e = { rspCode: "0000", pattern: null }; return e.rspCode = function () { const e = y.length; if (c.checkMin) { const t = c.min; if (e < t) return "1001" } if (c.checkMax) { const t = c.max; if (e > t) return "1002" } return "0000" }(), "0000" === e.rspCode && (e.pattern = parseInt(y.map(function (e) { return l.index(e) + 1 }).join(""))), e } function k() { y = [], p = void 0, b = void 0, s.removeClass("success error"), d.empty(), v.empty() } function C(e) { (e = e || t.event).preventDefault && e.preventDefault(), e.returnValue = !1 } function P(e) { if (i[e.keyCode]) return C(e), !1 } function S(e) { if (c.allowRepeat) return function (e) { return 0 !== y.length && e === y[y.length - 1] }(e); for (const t of y) if (t === e) return !0; return !1 } function L(e) { return function (t) { if (t.preventDefault(), p === e) { var n = function (e, t) { var n = E(t), o = n.x, r = n.y; return m.x = o, m.y = r, m.matrixTransform(e.getScreenCTM().inverse()) }(t.target, t); return e.setAttribute("x2", n.x), e.setAttribute("y2", n.y), !1 } } } function M(e, n) { if (!n) { var r = E(e), i = r.x, u = r.y; n = document.elementFromPoint(i, u) } n.getAttribute("cx"), n.getAttribute("cy"); (function (e) { for (const t of l) if (t === e) return !0; return !1 })(n) && !S(n) && (j(p, n), p = function (e) { y.push(e); var n = e.getAttribute("cx"), r = e.getAttribute("cy"), i = function (e, t, n, r) { var i = document.createElementNS(o, "line"); i.setAttribute("x1", e), i.setAttribute("y1", t), void 0 === n || null == r ? (i.setAttribute("x2", e), i.setAttribute("y2", t)) : (i.setAttribute("x2", n), i.setAttribute("y2", r)); return i }(n, r), u = function (e, t) { var n = document.createElementNS(o, "circle"); return n.setAttribute("cx", e), n.setAttribute("cy", t), n.setAttribute("r", 6), n }(n, r); v.append(u), b = L(i), s.on("touchmove mousemove", b), d.append(i), c.vibrate && (navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate, navigator.vibrate && t.navigator.vibrate(25)); return i }(n)) } function j(e, t) { if (void 0 !== e && (b && s.off("touchmove mousemove", b), void 0 !== t)) { var n = t.getAttribute("cx"), o = t.getAttribute("cy"); e.setAttribute("x2", n), e.setAttribute("y2", o) } } function E(e) { return { x: e.clientX || e.originalEvent.touches[0].clientX, y: e.clientY || e.originalEvent.touches[0].clientY } } (c = Object.assign(u.defaults, c || {})).hideLine ? x() : A(), s.on("touchstart mousedown", function (n) { k(), n.preventDefault(), function () { t.addEventListener && t.addEventListener("DOMMouseScroll", C, !1); t.onwheel = C, t.onmousewheel = document.onmousewheel = C, t.ontouchmove = C, document.onkeydown = P }(), s.on(r, M); var o = "touchstart" == n.type ? "touchend" : "mouseup"; e(document).one(o, function (e) { !function () { (function () { t.removeEventListener && t.removeEventListener("DOMMouseScroll", C, !1); t.onmousewheel = document.onmousewheel = null, t.onwheel = null, t.ontouchmove = null, document.onkeydown = null })(), j(p), p && p.remove(), s.off(r, M); var e = c.onPattern.call(a, w()); !0 === e ? h() : !1 === e && g() }() }) }), Object.assign(this, { clear: k, success: h, error: g, getPattern: w, switchHide: function () { c.hideLine = !c.hideLine, c.hideLine ? x() : A() } }) } return u.defaults = { onPattern: function () { }, allowRepeat: !1, hideLine: !1, checkMin: !0, checkMax: !0, min: 4, max: 9 }, u });